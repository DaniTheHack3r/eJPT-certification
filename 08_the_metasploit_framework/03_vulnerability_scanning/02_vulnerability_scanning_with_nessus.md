# Vulnerability Scanning With Nessus

+ Nessus is a proprietary vulnerability scanner developed by Tenable.

+ We can utilize Nessus to perform a vulnerability scan on a target system, after which, we can import the Nessus results in to MSF for analysis and exploitation.

+ Nessus automates the process of identifying vulnerabilities and also provides us with information pertinent to a vulnerability like the CVE code.

+ We can use the free version of Nessus (Nessus Essentials), which allows us to scan upto 16 IPs.

## Lab Environment

+ For the purposes of demonstrating the vulnerability scanning process, we will be utilizing an intentionally vulnerable virtual machine called Metasploitable3 that is based on Windows Server 2008.

+ Metasploitable3 was developed by Rapid7 to demonstrate how MSF can be used to perform exploitation of a Windows System.

+ Instructions on how this VM can be setup can be found here: https://bit.ly/3kASwns


## Laboratory

- We will start by installing Nessus in kali, following the link `https://www.tenable.com/products/nessus`. Choose Nessus essentials and register for activation code.

- Download the package pertinent to debian/kali linux.

- Give it execution permissions and install it using `dpkg`.

- Start it up by running `sudo systemctl start nessusd.service`. You can check status of the running service by typing `sudo systemctl status nessusd.service`.

- Then go to https://localhost:8834/ to configure the scanner. Choose Nessus essentials, skip registration, and paste the activation code when prompted to do so. Set up an administrative account. Then it will take a few minutes because it will need to download and compile its packages.

- Now we will use nessus to scan remote targets. We select the option new scan and then a new basic network scan. Fill up the form of nessus with name MS3 and the ip address of the target. In the options Discovery, Assessment, Report and Advanced can be left default. Then we will save it and start the scan. Schedule must be left on demand, in order to launch it when we want.

- When the scan is completed, we want to check the vulnerabilities in the vulnerabilities tab.

- We can apply a filter to check for vulnerabilities available in the metasploit framework.

**Note**: Inside each vulnerability is a tone of information, including the CVSS and the CVE.

**Note**: You can also filter by severity, which is pretty useful as well.

- Now we will export the results with the button `Export` and the the option `Nessus`.

- We will create a new workspace called MS3_Nessus.

- Now we will use `db_import $PATH_TO_NESSUS_RESULTS` to import all the results.

- We can now check hosts, services and vulns to check our results. To filter out the vulns list, we can use the `-p` and filter by port.

- With this information, we can use the command `search` to search by cve. Like this: `search cve:2017 name:smb`. By providing the year of the CVE and another piece of information like the name (in this case the service name was passes as argument) we can get a list of modules related to the cve. Sometimes, the CVE is not enough, so try the microsoft vulnerability identifier. From this, we can search for exploits and the try to exploit those vulnerabilities found with Nessus.

**Note**: From the vulnerability results in Nessus we can get the name of the exploit module and try to search for it inside the msfconsole.
