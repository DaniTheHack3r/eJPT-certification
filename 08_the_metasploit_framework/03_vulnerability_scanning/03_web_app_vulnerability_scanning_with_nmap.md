# Web App Vulnerability Scanning with WMAP

+ WMAP is a powerful, feature-rich web application vulnerability scanner that can be used to automate web server enumeration and scan web
applications for vulnerabilities.

+ WMAP is available as an MSF plugin and can be loaded directly into MSF.

+ WMAP is fully integrated with MSF, which consequently allows us to perform web app vulnerability scanning from within the MSF.

## Laboratory

- Start the postgresql server by running `service postgresql start`.

- Start the msfconsole and check the database status.

- Create a new workspace and import your nmap scan results. We can name it Web_Scanning for this example.

- Set globally the target IP with `setg RHOSTS $TARGET_IP`, do this for the RHOST option as well.

- Now from the msfconsole we are going to load the wmap plugin with `load wmap`. If we type wmap_ and try to autocomplete we will see that the plugin has different commands we could use.

- `wmap_sites` is used to specify a site in wmap. By running `wmap_sites -a $TARGET` we can add a site. A host name or ip address should be enough.

- We also need to use `wmap_targets` to specify the target urls. For example: `wmap_targets -t http://$TARGET_IP/`. Note the slash at the end to symbolize the path of the root directory.

- Now we need to run `wmap_run -t` in order to show all enabled modules before continuing. This command should load modules before listing them.

- After that, we will run `wmap_run -e` to run all matching modules against targets. When it finishes, it will display a whole lot of information that is very useful. For example, it will display available HTTP methods on the web server target.

- WMAP is also capable of showing us vulnerabilities found. By running `wmap_vulns` we get an idea of what it found. However, it usually show only found directories, which is not pretty useful.

- WMAP will also display modules from msf that it used. For example the `auxiliary/scanner/http/options`. If we test the module, it will have a similar output to the WMAP section describing options.

- Here comes an example, if the target directory of a website supports PUT http method, we could use the module `auxiliary/scanner/http/http_put` in order to exploit that vulnerability. In this scenario, the /data/ directory found in the robots.txt supports PUT.

**Note**: The module http_put will upload a file to the server, we could test it out by ourselves as well by running `curl http://$TARGET_IP/data/$NAME_OF_THE_FILE`.
