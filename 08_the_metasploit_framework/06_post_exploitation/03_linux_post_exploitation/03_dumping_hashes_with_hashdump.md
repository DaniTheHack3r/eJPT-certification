# Dumping Hashes with Hashdump

+ We can dump Linux user hashes with the hashdump post exploitation module.

**Note**: On linux, the hashdump utility must be loaded manually into meterpreter.

+ Linux password hashes are stored in the /etc/shadow file and can only be accessed by the root user or a user with root privileges.

+ The hashdump module can be used to dump the user account hashes from the /etc/shadow file and can also be used to unshadow the hashes for password cracking with John the Ripper.

## Laboratory

- Start the postgresql server by running `service postgresql start`.

- Start the msfconsole and check the database status.

- Create a new workspace and import your nmap scan results. We can name it hashdump for this example.

- Set globally the target IP with `setg RHOSTS $TARGET_IP`, do this for the RHOST option as well.

- We can start by using db_nmap to start scanning the target machine. Or you can import them from an external xlm nmap result file.

**Note**: The target machine is the next ip after your ip address. If your ip is x.x.x.2, the target IP will be x.x.x.3.

- We are going to start performing a quick search to see al exploit modules related to Samba `search type:exploit name:samba`. And we are going to pay attention to the module `exploit/linux/samba/is_known_pipename`. If we select the module, we only need to set up the RHOSTS, SMB_FOLER and SMB_SHARE_NAME. The module comes with its own payload by default, so there's no need to upgrade it.

**Note**: Remember you can run `/bin/bash -i` and you will get a bash session.

- To upgrade it to a meterpreter session run `sessions -u $SESSION_ID`.

- Let's try local enumeration on victim 2: `sysinfo`, `getuid`.

- We will use the module `post/linux/gather/hashdump` and set the session ID. we need root privileges.

**Note**: In this laboratory, to see the real effect of hashdump, we should provide root with a password. And add additional users if you wish.

**Note**: The passwd file gives us information in regards to the hashing algorithm that is being used and the password hash, this is very helpful as we are able to determine the type of hashing algorithm that is being used and its strength. We can determine this by looking at the number after the username encapsulated by the dollar symbol ($):
    + $1 -> MD5
    + $2 -> Blowfish
    + $5 -> SHA-256
    + $6 -> SHA-512

**Note**: We can only try to crack these hashes, as we cannot really use them for any other things like in windows where we can use the hashes in some cases.
