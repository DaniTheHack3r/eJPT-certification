# Linux Privilege Escalation: Exploiting a vulnerable program

+ The privilege escalation techniques we can utilize will depend on the version of the Linux kernel running on the target system as well as the distribution release version.

+ MSF offers very little in regards to Linux kernel exploit modules, however, in some cases, there may be an exploit module that can be utilized to exploit a vulnerable service or program in order to elevate our privileges.

**Note**: Of course, sometimes these programs can be exploited manually as well but it involves downloading malicious code on the target.

## Laboratory

- Start the postgresql server by running `service postgresql start`.

- Start the msfconsole and check the database status.

- Create a new workspace and import your nmap scan results. We can name it LinuxPrivEsc for this example.

- Set globally the target IP with `setg RHOSTS $TARGET_IP`, do this for the RHOST option as well.

- We can start by using db_nmap to start scanning the target machine. Or you can import them from an external xlm nmap result file.

**Note**: The target machine is the next ip after your ip address. If your ip is x.x.x.2, the target IP will be x.x.x.3.

- We have been provided with ssh credentials to directly access the target machine. Use the `auxiliary/scanner/ssh/ssh_login` module. It will provide us with a shell session.

- Start by performing some basic enumeration: `whoami`, `uname -r`, `cat /etc/*issue`.

- Upgrade the session to meterpreter using `session -u $SESSION_ID`.

- We are now logged as someone that is not root and we want to elevate our privileges. Start by performing some extra local enumeration by running `ps aux`. We will find that the root user ran a script which is not present on basic linux baseline, called `/bin/check-down`. By enumerating the content of this file we see that it executes a binary called `chkrootkit`. This binary is vulnerable to a local privilege escalation for versions < 0.50.

- We are going to use the module `exploit/unix/local/chkrootkit` to exploit the vulnerability. By setting the session, chkrootkit directory, and the payload options, we should have a shell session with root privileges by exploiting a vulnerability on chkrootkit.

Flag: 9db8bf8f483ff50857f26f9bd636bed6
