# Clearing Windows Event Logs

## Windows Event Logs

+ The Windows OS stores and catalogs all actions/events performed on the system and stores them in the Windows Event log.

+ Event logs are categorized based on the type of events they store:
    - Application logs: Stores application/program events like startups, crashes etc.
    - System logs: Stores system events like startups, reboots etc.
    - Security logs: Stores security events like password changes, authentication failures etc.

+ Event logs can be accessed via the Event Viewer on Windows.

+ The event logs are the first stop for any forensic investigator after a compromise has been detected. It is therefore very important to clear your tracks after you are done with your assessment.

**Note**: It is preferable to do all your actions as a pentester in memory, this makes it easier to cover your tracks as you will only need to wipe security logs.

## Laboratory

- Start the postgresql server by running `service postgresql start`.

- Start the msfconsole and check the database status.

- Create a new workspace and import your nmap scan results. We can name it Clearev for this example.

- Set globally the target IP with `setg RHOSTS $TARGET_IP`, do this for the RHOST option as well.

- We can start by using db_nmap to start scanning the target machine. Or you can import them from an external xlm nmap result file.

- Service: BadBlue 2.7. Exploit found: `exploit/windows/http/badblue_passthru`. Get access to the target machine with a meterpreter session. Set the meterpreter, reverse_tcp payload, to the x64 version for windows. Remember to set the target to the appropiate target version.

- Let's try local enumeration: `sysinfo`, `getuid`, `getprivs`. Consider the user you are currently logged in at, it should be Administrator.

- Now go to the target machine (it is available in this lab) and open `Event Viewer` on windows and check Security logs under Windows Logs. There shouldn't be anything logged as you only got initial access through an exploit in memory.

- Now we will change the administrator password by poping a cmd prompt shell from meterpreter. Then check again the logs, you should see new records in the Event Viewer in the security logs related to the password change.

- Now go back to meterpreter by killing the cmd prompt and run `clearev`. If we check again the logs from the target machine, we will see that the last log is `the audit log was cleared` for all types of logs (application, system and security).
