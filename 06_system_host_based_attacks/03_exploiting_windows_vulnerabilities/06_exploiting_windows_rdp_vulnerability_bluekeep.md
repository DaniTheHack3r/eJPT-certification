# Exploiting Windows CVE-2019-0708 RDP Vulnerability (BlueKeep)

This is a vulnerability of RDP that allows to execute remote code at a kernel level, by getting into a kernel chunk, and potentially establish a shell or meterpreter session with elevated privileges. The exploitation process can be quite confusing.

It was actually discovered by researches at microsoft and eventually patched.

**Note**: executing code at kernel level might lead to system crash.

Vulnerable systems are:
- XP
- Vista
- Windows 7
- Windows server 2008 & R2

**Note**: As Microsoft was the one that disclosed the vulnerability, there are no legitimate PoC or exploits out there and most of them might be malicious.

MSF has both an aulixiary module to check the target for the vulnerability and an exploit module that can be used to actually exploit the RDP vulnerability.

## Laboratory

- We start by executing a simple Nmap scan directly to the RDP port (3389).

**Note**: Inside the msfconsole we will use the two modules `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` and `exploit/windows/rdp/cve_2019_0708_bluekeep_rce`.

- We start by using `auxiliary/scanner/rdp/cve_2019_0708_bluekeep`, just fill RHOSTS.

- Now we use the module `exploit/windows/rdp/cve_2019_0708_bluekeep_rce` to exploit the vulnerability. This module only works with the x64 version of the payload which should match your target system. At this point, it should fail as target should be specified manually the right way.

- We can enum available targets running `show targets` in msfconsole. And then run `set target $ID`. And we can perform the exploitation again.

**Note**: The groom size is default to 250MB. However, if the memory allocated to the target system is lower than that, it will crash. This is something that you need to know before hand because you cannot afford to crash target systems in real life.