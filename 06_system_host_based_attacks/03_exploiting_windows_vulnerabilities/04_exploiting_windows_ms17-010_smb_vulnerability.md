# Exploiting Windows MS17-010 SMB Vulnerability (EternalBlue)

This laboratory has to be configured in your home lab as there is not a laboratory available.
You can take notes as the lab goes as well.

- It can be checked using the MSF.
- In addition to MSF, we can also exploit it manually with a tool called AutoBlue-MS17-010 (https://github.com/3ndG4me/AutoBlue-MS17-010).

# Laboratory

- Simple service detection using nmap.
- We are focusing on smb ports (445).
- We are going to use the script `smb-vuln-ms17-010` with nmap.
- We start exploiting the vulnerability manually using AutoBlue-MS17-010. It comes prepackaged with different eternalblue exploit scripts written in python for different versions of windows. The first step is to generate the shellcode using the script shell_prep.sh inside the repo, remember to setup if stageless and if meterpreter or cmd shell.
*Note*: LHOST is the attacking machine and RHOST is the victim.
*Note*: Remember that your shellcode will have the name sc_x86.bin or sc_x64.bin name.
- Run netcat to prepare your machine to start listening for connections with `nc -nvlp $PORT`
- Now we run the eternalblue_exploit script with its corresponding shellcode like this: `python eternalblue_exploit7.py x.x.x.x /path-to-shellcode`.
- Now to do it with MSF, we run msfconsole. To know if the target is vulnerable, we can use the `auxiliary/scanner/smb/smb_ms17_010` module and to exploit it we can run the `exploit/windows/smb/ms17_010_eternalblue` module.
- We already know that the target is vulnerable, so we select the exploitation module and set the RHOST value. It should be enough to exploit it and get a meterpreter session.
