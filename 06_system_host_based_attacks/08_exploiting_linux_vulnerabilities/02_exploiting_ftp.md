# Exploiting FTP

- FTP (File Transfer Protocol) is a protocol that uses TCP port 21 by default, and is used to facilitate file sharing between a server and client/clients.

**Note**: FTP can be configured to run in different ports, that is something you might keep in mind.

- It is also frequently used as a means of transferring files to and from the directory of a web server.

- FTP authentication requires a username and password combination. As a result, we can perform a brute-force attack on the FTP server in order to identify legitimate credentials.

- In some cases, FTP servers may be configured to allow anonymous access, which consequently allows anyone to access to the FTP server without providing any legitimate credentials.

**Note**: Anonymous access is not something you will find on the wild quite a lot, as when ftp is enabled, is kept all secure quite well.

**Note**: The only exploitation vector to get access to an ftp server is through a brute force attack, or by exploiting a inherit vulnerability of specific FTP versions, which is quite uncommon to choose as a vector, as there are plenty of FTP services for linux developed by different individuals or companies and it will depend on how well kept are those ftp service packages on the linux target and a brute force attack could be rather successful.

## Laboratory

In this laboratory you won't be provided with the target IP address, but you can take your own IP address in the subnet and use the machine in the next ip address. For example x.x.x.2 is your machine and x.x.x.3 is the target.

- Start by performing an nmap scan with service detection. You should see the ftp port 21 open and the ProFTPD version 1.3.5a running on that port.

**Note**: There could be an inherent vulnerability in ProFTPD version 1.3.5a, it is worth exploring.

- Check first for anonymous access. Just try to login running `ftp x.x.x.x` and write `anonymous` when prompted for username and an empty string when prompted for password. If failed messages are displayed, the ftp server is not configured with anonymous connections.

- You could also check if the ftp server has anonymous access by running the nmap script `ftp-anon` with no arguments.

**Note**: If you want to list or look up nmap scripts, you could run `ls -al /usr/share/nmap/scripts/ | grep $DESIRED_PATTERN`.

- Now we are going to perform a brute force attack using hydra, like this: `hydra -L /path/to/username/list -P /path/to/password/list x.x.x.x -t $THREATS $PROTOCOL`.

**Note**: The lists recommended for this exercise are `/usr/share/metasploit-framework/data/wordlists/common_users.txt` for users and `/usr/share/metasploit-framework/data/wordlists/unix_passwords.txt` for passwords.

- Once you get some users and passwords, try connecting to the ftp server and getting all the information you can.

**Note**: If you want to look up vulnerabilities, you can use the cli `searchsploit` which is a look up tool where you can get information about software vulnerabilities and exploits and where to find them. For example `searchsploit ProFTPD` and you will get information about any vulnerability listed on the sploit database. In this case ProFTP 1.3.5 has an exploit module in metasploit, even if the current version is 1.3.5a, we could try to exploit the same vulnerability in that version.
