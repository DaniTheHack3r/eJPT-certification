# Case Studies

1. Heartbleed (CVE-2014-0160)

CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-0160
NVD: https://nvd.nist.gov/vuln/detail/cve-2014-0160

Heartbleed is a vulnerability that allows attackers to leak information from the memory, including passwords and cryptographic keys. This vulnerability affects OpenSSL and any library or program that utilize OpenSSL on its versions 1.0.1 before 1.0.1g.

**Note**: When reading about vulnerabilities, consider taking a look at the references available in each page.

**Note**: You can scan for this vulnerability using the script `ssl-enum-ciphers`, for example: `nmap -sV --script ssl-enum-ciphers -p 443 x.x.x.x`. However, you can go even deeper checking for heartbleed using the script `ssl-heartbleed`.

**Note**: OpenSSL can be utilized by the port 443 HTTPS, but it can also be used by other ports, so consider that.

Now if you want to find proves of concept, exploits or similar things, check out the exploit database (https://www.exploit-db.com/).

2. Eternal Blue (CVE-2017-0143)

CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
NVD: https://nvd.nist.gov/vuln/detail/cve-2017-0143

It was part of the wannacry ransomware attack, this started as a zero day exploit that affected SMBv1 in a buffer overflow situation, basically, it can give you access to remote code execution. It is well known that the United States National Security Agency (NSA) discovered the vulnerability and created an exploit for it, it was released short after by insider threats as part of their toolkit and then exploited around the world. Almost all operating systems used at the time that weren't patched were vulnerable and microsoft didn't know it existed until found in the wild. Such a ubiquitous vulnerability had severe consequences.

**Note**: There is a specific Nmap script to detect this vulnerability `smb-vuln-ms17-010` where MS17-010 is the naming system of Microsoft interal bug database.

**Note**: MS08-067 is the name of another old vulnerability similar to MS17-010.

Now if you want to find proves of concept, exploits or similar things, check out the exploit database (https://www.exploit-db.com/) using the name ms17-010.

**Note**: Exploiting EternalBlue in a machine could lead to severe damage to the current operations inside the system as if done umproperly, it could lead to SMBv1 shut down. Consider always using a secure script like the one from Nmap and understand the implications of exploiting there where you scan.

**Note**: Operation Technology could fall victim of this exploit as those systems usually doesn't require an update.

3. Log4J (CVE-2021-44228)

CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2021-44228
NVD: https://nvd.nist.gov/vuln/detail/CVE-2021-44228

Apache Log4J is a loggin library used by Java to log. Some versions do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log messages parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled.

**Note**: The Nmap script to detect the log4j vulnerability was still under development at the time of recording of the class there are some options available around but make sure you understand the scripts before running them.

**Note**: Log4J is used by many different types of services and applications. The problem is footprinting them, so it more common tu see this vulnerability in apache tomcat serving web applications for example. Many games and desktop apps run in java, and that is why is difficult to get information about them.

Behind curtains what happens in log4j is that the code is evaluated instead of being parsed, so it is a type of injection is happening there. That injection calls your LDAP server and brings code that can be executed once it is pulled.